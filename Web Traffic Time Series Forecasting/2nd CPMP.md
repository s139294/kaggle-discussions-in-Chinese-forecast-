# Web Traffic Time Series Forecasting第2名

---
    该比赛分两个阶段，第一阶段训练数据从15年7月1日~16年12月31日，LB为17年1月1日~17年3月1日。第二阶段训练数据为15年7月1日~17年9月1日，LB为17年9月13日~17年11月13日（62天）。


该方法由5个思路构成。
##1、年季节性
第一个思路是利用数据的**年季节性/周期性(yearly seasonality)**。

周季节性对于某些网址（如es.wikipedia.com）而言十分明显，但是对于其他一些网址来说却几乎不存在。但是最重要的，数据中存在着显著的年季节性。因此，我使用交叉验证的方法，在12个月前的数据上训练我的模型。

 - 对于阶段1：
    - CV：特征提取：2015.7.1~2015.12.31，验证：2016.1.1~2016.3.1
    - LB：特征提取：2016.7.1~2016.12.31，预测：2017.1.1~2017.3.1

 - 对于阶段2：
    - CV：特征提取：2016.3.14~2016.9.10(181天)，验证：2016.9.13~2016.11.13(62天)
    - LB：特征提取：2017.3.14~2017.9.10(181天)，预测：2017.9.13~2017.11.13(62天)

为了除去年趋势(yearly trend)并保留年季节性，我从训练和测试数据中减去了最后20周训练数据的中位数，这样值的范围在不同年之间就是相近的了（？）。这用于解决XGBBoost无法真正进行预测/外推(extrapolate)的问题。

我使用了5fold的CV，数据根据网页进行分割（同一网页的数据必须在同一fold中，不然模型会过拟合）。我取了各fold模型预测值的中位数作为提交结果。预测结果四舍五入，小于0的被置为0。

第一个思路其实是在打赌，我无法预判它在第二阶段的表现。





    hans：代码部分的一些总结：
    - cv滑窗的构建
    - tqdm：进度条
    - dataframe的pivot函数：构建二维表格
    
    